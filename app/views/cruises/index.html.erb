<div class="page-container">
    <div class="header-content">
      <div class="cruise-header">
        <h1 class="block">Choose Your Sailings</h1>
        <h3 class="block" id="pick-one">(Pick one for each box)</p>
      </div>
    </div>

    <% cruiseLineInfo = @response.parsed_response['cruise_lines'] %>

    <div class="cruise-container">
      <div class="card-container">
        <% @response.parsed_response['sailings'].each do |cruise| %>
          <% picture = cruise['sailing_main_image'] %>
          <div class="card">
            <div class="card-image">
              <%= image_tag picture, alt:'cruise picture!'%>
            </div>
            <div class="card-footer">
              <% cruiseLineInfo.each do |cruiseLines| %>
                <% if cruiseLines['cruise_line_id'] == cruise['sailing_cruise_line_id'] %>
                  <% @cruise_line_name = cruiseLines['cruise_line_name'] %>
                  <% @cruise_ship_name = cruiseLines['cruise_ship_name'] %>
                <% end %>
              <% end %>
              <p class="cruise-p"><%= @cruise_line_name %> - <%= @cruise_ship_name %> </p>
              <h2><%= cruise['sailing_name'] %></h2>
              <% cruise['sailing_options'].each do |option| %>
                <div class="cell">
                  <div class="check">
                      <input id="check-0" type="checkbox" />
                      <label for="check-0"><span><%= option['sailing_date'] %></span><span class='price'><%= ' $' + (option['sailing_price']).to_s %></span></label>
                  </div>
                </div>
              <% end %>
            </div>
          </div>
        <% end %>
      </div>
    </div>


    <div class="savings-container">
      <div class="cruise-header">
        <h1 id="savings-h1">Your Selected Savings Total</h1>
      </div>
      <h1 id="price">$0</h1>
    </div>
</div>


<script type="text/javascript">
$(".cell").on("click", "input:checkbox", function () {
  var $items = $(".cell").find("input:checkbox:checked");
  var $total = $("#price");
  var cur_total = 0;

  $items.each(function () {
      var $this = $(this);
      var $target = $(".price");
      var item_value = +($target.html().replace("$", "") || 0);

      cur_total += item_value;
  });

  $total.html("$" + cur_total);
});
</script>
